<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YargÄ±tay KararlarÄ± - Emsal Arama Sistemi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .search-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
            background: white;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #667eea;
            font-size: 1.2rem;
        }

        .ai-search-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .ai-search-box h3 {
            color: white;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-search-box textarea {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            resize: vertical;
            min-height: 100px;
            background: rgba(255, 255, 255, 0.95);
        }

        .ai-search-box textarea:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        .search-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            height: 70vh;
        }

        .results-panel, .detail-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .panel-header h3 {
            color: #2c3e50;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .results-list {
            flex: 1;
            overflow-y: auto;
        }

        .decision-item {
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .decision-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .decision-item.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .decision-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .decision-number {
            font-weight: 700;
            color: #2c3e50;
            font-size: 1.1rem;
        }

        .similarity-score {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: auto;
        }

        .decision-summary {
            color: #7f8c8d;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-top: 10px;
        }

        .decision-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .meta-item {
            color: #95a5a6;
        }

        .detail-content {
            flex: 1;
            overflow-y: auto;
            line-height: 1.7;
        }

        .detail-placeholder {
            text-align: center;
            color: #95a5a6;
            font-style: italic;
            padding: 50px 20px;
        }

        .decision-full-text {
            white-space: pre-wrap;
            font-size: 1rem;
            line-height: 1.7;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-style: italic;
        }

        .api-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #ffd700;
        }

        .api-section h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .api-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .api-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        .api-button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .results-panel, .detail-panel {
                height: 50vh;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a6fd8, #6b4190);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âš–ï¸ YargÄ±tay KararlarÄ±</h1>
            <p>Emsal Arama ve Analiz Sistemi</p>
        </div>

        <div class="search-section">
            <div class="api-section">
                <h4>ğŸ”‘ Gemini API AnahtarÄ± (Yapay Zeka Analizi Ä°Ã§in)</h4>
                <div class="api-input">
                    <input type="password" id="apiKeyInput" placeholder="Gemini API anahtarÄ±nÄ±zÄ± girin (isteÄŸe baÄŸlÄ±)">
                    <button class="api-button" onclick="setApiKey()">Kaydet</button>
                </div>
                <div id="apiStatus">
                    <span style="color: #f39c12;">âš ï¸ API anahtarÄ± yoksa basit arama kullanÄ±lacak</span>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="keywordSearch" placeholder="Anahtar kelime girin (Ã¶rn: tapu, miras, sÃ¶zleÅŸme...)">
                <span class="search-icon">ğŸ”</span>
            </div>

            <div class="ai-search-box">
                <h3>ğŸ¤– Yapay Zeka Destekli Benzerlik AramasÄ±</h3>
                <textarea id="aiSearch" placeholder="AradÄ±ÄŸÄ±nÄ±z hukuki durumu detaylÄ± olarak aÃ§Ä±klayÄ±n. Ã–rnek: 'SatÄ±ÅŸ sÃ¶zleÅŸmesinde ayÄ±p nedeniyle alÄ±cÄ±nÄ±n sÃ¶zleÅŸmeden dÃ¶nme hakkÄ± ve tazminat talep etmesi durumunda...'"></textarea>
                <button class="search-button" onclick="performSearch()">
                    <span>ğŸ”</span>
                    Ara ve Analiz Et
                </button>
            </div>
        </div>

        <div class="main-content">
            <div class="results-panel">
                <div class="panel-header">
                    <h3>ğŸ“‹ Bulunan Kararlar</h3>
                </div>
                <div class="results-list" id="resultsList">
                    <div class="detail-placeholder">
                        Veriler yÃ¼kleniyor...
                    </div>
                </div>
            </div>

            <div class="detail-panel">
                <div class="panel-header">
                    <h3>ğŸ“„ Karar DetayÄ±</h3>
                </div>
                <div class="detail-content" id="detailContent">
                    <div class="detail-placeholder">
                        Bir karar seÃ§in ve detaylarÄ±nÄ± burada gÃ¶rÃ¼ntÃ¼leyin
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global deÄŸiÅŸkenler
        let GEMINI_API_KEY = '';
        let allDecisions = [];
        let currentResults = [];
        let selectedDecision = null;

        // Ã–rnek veri - gerÃ§ek uygulamada JSON dosyanÄ±zdan yÃ¼klenecek
        const sampleDecisions = [
            {
                id: 1,
                number: "2023/1245 K.2023/2156",
                court: "15. Hukuk Dairesi",
                date: "2023-05-15",
                keywords: ["tapu", "mÃ¼lkiyet", "iktisap"],
                summary: "Tapu sicilinde kayÄ±tlÄ± malik sÄ±fatÄ±yla dava aÃ§ma yetkisi ve iyiniyetli Ã¼Ã§Ã¼ncÃ¼ kiÅŸilerin durumu",
                fullText: `YARGITAY 15. HUKUK DAÄ°RESÄ°

Esas No: 2023/1245
Karar No: 2023/2156
Karar Tarihi: 15.05.2023

Ã–ZET: Tapu sicilinde malik olarak gÃ¶zÃ¼ken kiÅŸinin o taÅŸÄ±nmaza iliÅŸkin dava aÃ§ma yetkisi bulunduÄŸu, ancak iyiniyetli Ã¼Ã§Ã¼ncÃ¼ kiÅŸilerin haklarÄ±nÄ±n da korunmasÄ± gerektiÄŸi...

KARAR:
Mahkemece, davalÄ±nÄ±n tapu sicilinde malik olarak gÃ¶zÃ¼kmediÄŸi, bu nedenle dava aÃ§ma yetkisinin bulunmadÄ±ÄŸÄ± gerekÃ§esiyle davanÄ±n reddine karar verilmiÅŸ...

Bu durumda mahkeme kararÄ±nda hukuki isabet gÃ¶rÃ¼lmemiÅŸtir. Zira TÃ¼rk Medeni Kanunu'nun 1007. maddesi gereÄŸince, tapu sicilindeki kayÄ±tlar lehine hÃ¼kÃ¼m ifade eder...`
            },
            {
                id: 2,
                number: "2023/2341 K.2023/3245",
                court: "11. Hukuk Dairesi", 
                date: "2023-08-22",
                keywords: ["sÃ¶zleÅŸme", "satÄ±ÅŸ", "ayÄ±p"],
                summary: "SatÄ±ÅŸ sÃ¶zleÅŸmesinde ayÄ±p nedeniyle sÃ¶zleÅŸmeden dÃ¶nme ve tazminat talep edilmesi",
                fullText: `YARGITAY 11. HUKUK DAÄ°RESÄ°

Esas No: 2023/2341
Karar No: 2023/3245
Karar Tarihi: 22.08.2023

Ã–ZET: SatÄ±lan malda ayÄ±p bulunmasÄ± halinde alÄ±cÄ±nÄ±n seÃ§imlik haklarÄ± ve tazminat talebinin koÅŸullarÄ±...

KARAR:
DavacÄ±, satÄ±n aldÄ±ÄŸÄ± aracÄ±n ayÄ±plÄ± olduÄŸunu, bu nedenle sÃ¶zleÅŸmeden dÃ¶ndÃ¼ÄŸÃ¼nÃ¼ ve Ã¶dediÄŸi bedelin iadesini talep etmiÅŸtir...

TÃ¼rk BorÃ§lar Kanunu'nun 227. maddesi uyarÄ±nca, satÄ±lan ÅŸeyin ayÄ±plÄ± olmasÄ± durumunda alÄ±cÄ±nÄ±n seÃ§imlik haklarÄ± vardÄ±r...`
            },
            {
                id: 3,
                number: "2023/3456 K.2023/4567",
                court: "2. Hukuk Dairesi",
                date: "2023-09-10", 
                keywords: ["miras", "tereĞºĞµ", "paylaÅŸÄ±m"],
                summary: "Miras ortaklÄ±ÄŸÄ±nÄ±n giderilmesi ve terĞµkenin paylaÅŸÄ±mÄ±na iliÅŸkin esaslar",
                fullText: `YARGITAY 2. HUKUK DAÄ°RESÄ°

Esas No: 2023/3456
Karar No: 2023/4567
Karar Tarihi: 10.09.2023

Ã–ZET: Miras ortaklÄ±ÄŸÄ±ndan Ã§Ä±kma ve terekenin paylaÅŸÄ±mÄ±nda uygulanacak kurallar...

KARAR:
DavacÄ± mirasÃ§Ä±lar, miras ortaklÄ±ÄŸÄ±ndan Ã§Ä±kmak ve paylarÄ±na dÃ¼ÅŸen miras payÄ±nÄ±n kendilerine verilmesini talep etmiÅŸlerdir...

TÃ¼rk Medeni Kanunu'nun 640. maddesi uyarÄ±nca, mirasÃ§Ä±larÄ±n her biri istediÄŸi zaman miras ortaklÄ±ÄŸÄ±nÄ±n giderilmesini isteyebilir...`
            }
        ];

        // Veri doÄŸrulama ve temizleme fonksiyonu
        function validateAndCleanDecision(decision) {
            return {
                id: decision.id || Math.random(),
                number: decision.number || 'Bilinmeyen',
                court: decision.court || 'Bilinmeyen Daire',
                date: decision.date || new Date().toISOString().split('T')[0],
                keywords: Array.isArray(decision.keywords) ? decision.keywords : [],
                summary: decision.summary || 'Ã–zet bulunmuyor',
                fullText: decision.fullText || 'Tam metin bulunmuyor'
            };
        }

        // JSON DosyasÄ±ndan Veri YÃ¼kleme
        async function loadDecisions() {
            const resultsList = document.getElementById('resultsList');
            
            try {
                // GitHub Pages iÃ§in doÄŸru yol - proje kÃ¶k dizininden
                const possiblePaths = [
                    './json_files/ornek_kararlar.json',
                    './ornek_kararlar.json',
                    'json_files/ornek_kararlar.json',
                    'ornek_kararlar.json'
                ];

                let response = null;
                let successfulPath = null;

                for (const path of possiblePaths) {
                    try {
                        console.log(`Denenen yol: ${path}`);
                        response = await fetch(path);
                        if (response.ok) {
                            successfulPath = path;
                            break;
                        }
                    } catch (e) {
                        console.log(`${path} denenirken hata:`, e.message);
                    }
                }

                if (!response || !response.ok) {
                    throw new Error('JSON dosyasÄ± hiÃ§bir yolda bulunamadÄ±');
                }

                const rawDecisions = await response.json();
                console.log('Ham veri:', rawDecisions);

                // Veriyi doÄŸrula ve temizle
                const decisions = Array.isArray(rawDecisions) 
                    ? rawDecisions.map(validateAndCleanDecision)
                    : [validateAndCleanDecision(rawDecisions)];

                allDecisions = decisions;
                console.log(`${decisions.length} karar baÅŸarÄ±yla yÃ¼klendi (${successfulPath})`);
                
                resultsList.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #27ae60;">
                        âœ… ${decisions.length} YargÄ±tay kararÄ± baÅŸarÄ±yla yÃ¼klendi<br>
                        <small style="color: #7f8c8d; margin-top: 10px;">Kaynak: ${successfulPath}</small><br>
                        <small style="color: #7f8c8d;">Arama yapmaya hazÄ±r!</small>
                    </div>
                `;

            } catch (error) {
                console.error('Veri yÃ¼kleme hatasÄ±:', error);
                // Hata durumunda Ã¶rnek verilerle devam et
                allDecisions = sampleDecisions.map(validateAndCleanDecision);
                resultsList.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #e74c3c;">
                        âš ï¸ JSON dosyasÄ± yÃ¼klenemedi, Ã¶rnek verilerle Ã§alÄ±ÅŸÄ±yor<br>
                        <small style="color: #7f8c8d;">JSON dosyanÄ±zÄ± proje kÃ¶k dizinine veya json_files/ klasÃ¶rÃ¼ne koyun</small><br>
                        <small style="color: #95a5a6;">Hata: ${error.message}</small>
                    </div>
                `;
            }
        }

        // Gemini API ile benzerlik analizi
        async function analyzeWithGemini(searchQuery, decisions) {
            if (!GEMINI_API_KEY) {
                throw new Error('Gemini API key gerekli');
            }

            try {
                const prompt = `
Sen bir hukuki karar analiz uzmanÄ±sÄ±n. AÅŸaÄŸÄ±daki arama sorgusu ile verilen YargÄ±tay kararlarÄ± arasÄ±nda benzerlik analizi yap.

ARAMA SORGUSU: "${searchQuery}"

YARGITAY KARARLARI:
${decisions.map((decision, index) => `
${index + 1}. Karar ID: ${decision.id}
Karar No: ${decision.number}
Ã–zet: ${decision.summary}
Anahtar Kelimeler: ${decision.keywords.join(', ')}
`).join('')}

GÃ–REV: Her karar iÃ§in 0-100 arasÄ±nda benzerlik skoru ver. Hukuki kavramlar, konular ve uygulanabilirlik aÃ§Ä±sÄ±ndan deÄŸerlendir.

Ã‡IKTI FORMATI (sadece JSON):
{
  "results": [
    {"id": 1, "score": 85, "reason": "Tapu ve mÃ¼lkiyet konularÄ± tamamen uyuÅŸuyor"},
    {"id": 2, "score": 45, "reason": "SÃ¶zleÅŸme hukuku genel benzerlik"},
    {"id": 3, "score": 20, "reason": "Miras hukuku farklÄ± alan"}
  ]
}
`;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.1,
                            maxOutputTokens: 2048
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`Gemini API error: ${response.status}`);
                }

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;
                
                // JSON Ã§Ä±kartma
                const jsonMatch = aiResponse.match(/\{[\s\S]*\}/);
                if (jsonMatch) {
                    const analysisResult = JSON.parse(jsonMatch[0]);
                    return analysisResult.results || [];
                }
                
                throw new Error('GeÃ§ersiz AI yanÄ±tÄ±');
                
            } catch (error) {
                console.error('Gemini API hatasÄ±:', error);
                throw error;
            }
        }

        // Basit benzerlik hesaplama (fallback)
        function calculateSimpleSimilarity(searchText, decision) {
            if (!searchText.trim()) return 0;
            
            const searchWords = searchText.toLowerCase().split(/\s+/);
            const decisionText = (decision.summary + ' ' + decision.fullText + ' ' + (decision.keywords ? decision.keywords.join(' ') : '')).toLowerCase();
            
            let matchCount = 0;
            searchWords.forEach(word => {
                if (decisionText.includes(word)) {
                    matchCount++;
                }
            });
            
            return Math.round((matchCount / searchWords.length) * 100);
        }

        // API Key yÃ¶netimi
        function setApiKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            const statusDiv = document.getElementById('apiStatus');
            
            if (!apiKey) {
                statusDiv.innerHTML = '<span style="color: #e74c3c;">âŒ API anahtarÄ± boÅŸ olamaz</span>';
                return;
            }
            
            GEMINI_API_KEY = apiKey;
            statusDiv.innerHTML = '<span style="color: #27ae60;">âœ… API anahtarÄ± kaydedildi</span>';
            
            // API anahtarÄ±nÄ± gizle
            document.getElementById('apiKeyInput').value = '';
        }

        async function performSearch() {
            const keywordSearch = document.getElementById('keywordSearch').value;
            const aiSearch = document.getElementById('aiSearch').value;
            const resultsList = document.getElementById('resultsList');
            
            if (!keywordSearch.trim() && !aiSearch.trim()) {
                alert('LÃ¼tfen anahtar kelime veya AI arama alanÄ±nÄ± doldurun');
                return;
            }
            
            resultsList.innerHTML = '<div class="loading">ğŸ” Arama yapÄ±lÄ±yor...</div>';
            
            try {
                // Veri kontrol
                const dataSource = allDecisions.length > 0 ? allDecisions : sampleDecisions;
                let filteredResults = [...dataSource];
                
                console.log('KullanÄ±lan veri kaynaÄŸÄ±:', dataSource.length, 'karar');
                
                // Anahtar kelime filtresi
                if (keywordSearch.trim()) {
                    const keywords = keywordSearch.toLowerCase().split(/\s+/);
                    filteredResults = filteredResults.filter(decision => {
                        // GÃ¼venli veri eriÅŸimi
                        const keywordsText = decision.keywords ? decision.keywords.join(' ') : '';
                        const summaryText = decision.summary || '';
                        const fullText = decision.fullText || '';
                        
                        const searchText = (keywordsText + ' ' + summaryText + ' ' + fullText).toLowerCase();
                        return keywords.some(keyword => searchText.includes(keyword));
                    });
                }
                
                if (filteredResults.length === 0) {
                    currentResults = [];
                    displayResults();
                    return;
                }
                
                // AI benzerlik skorlarÄ± hesapla
                if (aiSearch.trim()) {
                    resultsList.innerHTML = '<div class="loading">ğŸ¤– Yapay zeka analiz ediyor...</div>';
                    
                    try {
                        if (GEMINI_API_KEY) {
                            // Gemini API ile analiz
                            const aiAnalysis = await analyzeWithGemini(aiSearch, filteredResults);
                            
                            // AI sonuÃ§larÄ±nÄ± kararlarla eÅŸleÅŸtir
                            filteredResults = filteredResults.map(decision => {
                                const aiResult = aiAnalysis.find(result => result.id === decision.id);
                                return {
                                    ...decision,
                                    similarityScore: aiResult ? aiResult.score : 0,
                                    aiReason: aiResult ? aiResult.reason : 'Analiz edilemedi'
                                };
                            }).filter(decision => decision.similarityScore > 10);
                            
                            // Benzerlik skoruna gÃ¶re sÄ±rala
                            filteredResults.sort((a, b) => b.similarityScore - a.similarityScore);
                        } else {
                            throw new Error('API anahtarÄ± yok');
                        }
                        
                    } catch (error) {
                        console.warn('Gemini API hatasÄ±, basit algoritma kullanÄ±lÄ±yor:', error);
                        
                        // Fallback: Basit benzerlik hesaplama
                        filteredResults = filteredResults.map(decision => ({
                            ...decision,
                            similarityScore: calculateSimpleSimilarity(aiSearch, decision),
                            aiReason: 'Basit kelime eÅŸleÅŸtirme ile'
                        })).filter(decision => decision.similarityScore > 0);
                        
                        filteredResults.sort((a, b) => b.similarityScore - a.similarityScore);
                    }
                } else {
                    // AI arama yoksa tarih sÄ±rasÄ±na gÃ¶re sÄ±rala
                    filteredResults.sort((a, b) => new Date(b.date) - new Date(a.date));
                }
                
                currentResults = filteredResults;
                displayResults();
                
            } catch (error) {
                console.error('Arama hatasÄ±:', error);
                resultsList.innerHTML = `
                    <div class="no-results">
                        âŒ Arama sÄ±rasÄ±nda hata oluÅŸtu<br>
                        <small style="color: #95a5a6;">${error.message}</small>
                    </div>
                `;
            }
        }

        function displayResults() {
            const resultsList = document.getElementById('resultsList');
            
            if (currentResults.length === 0) {
                resultsList.innerHTML = '<div class="no-results">âŒ Arama kriterlerinize uygun karar bulunamadÄ±</div>';
                return;
            }
            
            const resultsHtml = currentResults.map(decision => `
                <div class="decision-item" onclick="selectDecision(${decision.id})">
                    <div class="decision-header">
                        <div class="decision-number">${decision.number}</div>
                        ${decision.similarityScore ? `<div class="similarity-score">${decision.similarityScore}% ben
